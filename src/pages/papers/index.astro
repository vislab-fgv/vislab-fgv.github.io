---
import Layout from '../../layouts/Layout.astro';
import PaperCard from '../../components/PaperCard.astro';
import type { Paper } from '../../types/paper';
import papersData from '../../data/papers.json';


// Import your papers data
const papers = papersData as Paper[];

// Sort papers by year in descending order, then by pub_date
const sortedPapers = papers.sort((a, b) => {
  if (a.year !== b.year) {
    return b.year - a.year;
  }
  return new Date(b.pub_date).getTime() - new Date(a.pub_date).getTime();
});

// Group papers by year
const papersByYear = sortedPapers.reduce((acc, paper) => {
  const year = paper.year;
  if (!acc[year]) {
    acc[year] = [];
  }
  acc[year].push(paper);
  return acc;
}, {} as Record<number, Paper[]>);

// Get years in descending order
const years = Object.keys(papersByYear).sort((a, b) => Number(b) - Number(a));
---

<Layout title="Papers">
  <main class="container mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold mb-8">Publications</h1>

    {years.map(year => (
      <div class="mb-12">
        <h2 class="text-2xl font-semibold mb-6">{year}</h2>
        <div class="space-y-8">
          {papersByYear[Number(year)].map(paper => (
            <PaperCard paper={paper} />
          ))}
        </div>
      </div>
    ))}
  </main>
</Layout>